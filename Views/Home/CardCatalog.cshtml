@model List<GameCraft.Models.Card>

@{
    ViewData["Title"] = "Cards Catalog";
    Layout = "_Layout"; // Ensures this view uses your main public layout
}

<section class="cards-catalog-section">
    <div class="container">
        <h2 class="section-title">Available GameCraft Cards</h2>
        <h3>Purchase your official GameCraft card for seamless ticket tracking and exclusive perks!</h3>

        @if (Model != null && Model.Any())
        {
            <div class="cards-grid">
                @foreach (var card in Model)
                {
                    <div class="card-item">
                        <div class="card-image-container">
                            <img src="data:image/png;base64,@(Convert.ToBase64String(card.ImageData))" alt="@card.Name" class="card-image" onerror="this.onerror=null;this.src='https://placehold.co/300x200/333/fff?text=GameCraft+Card';" />
                        </div>
                        <h3 class="card-name">@card.Name</h3>

                        <div class="card-benefits">
                            @* Split the description by new line characters to create a dynamic list of benefits *@
                            @{
                                var benefits = card.Description.Split('\n', StringSplitOptions.RemoveEmptyEntries);
                            }
                            <ul>
                                @foreach (var benefit in benefits)
                                {
                                    <li>@benefit</li>
                                }
                            </ul>
                        </div>

                        <p class="card-price">Price: <strong>$@card.Price.ToString("F2")</strong></p>

                        @* Form to submit the card for checkout *@
                        <form asp-action="StartCardCheckout" asp-controller="Payment" method="post">
                            <input type="hidden" name="cardId" value="@card.CardId" />
                            <button type="submit" class="buy-now-button">Buy now</button>
                        </form>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="no-cards-message">No cards available at the moment. Check back soon!</p>
        }
    </div>
</section>
